* [Logging in to Stat](#logging-in-to-stat)
* [Ticket Creation](#ticket-creation)
* [Ticket Routing in Stat](#ticket-routing-in-stat)
* [MOC Staff Tickets](#moc-staff-tickets)
* [Resolving a Ticket](#resolving-a-ticket)
* [Contact UMass for Help](#contact-umass-for-help)

### Logging in to Stat

URL: [https://stat.umasscs.net/stat/](https://stat.umasscs.net/stat/)

Username is usually first initial, last name, so John Smith would have username `jsmith`.  When your account is first created, you will receive a temporary password via email.  

***

### Ticket creation

Access Requests and Quota Change tickets are generated by check-approved-requests.py.  This script runs in a cronjob, so once a request is Approved, the rest happens automatically.

Password reset requests are generated by the form at:

(for Kaizen) https://info.massopen.cloud:5001/reset     
(for Engage1) https://e1-helpdesk.massopen.cloud/reset

General tickets are currently generated by a form at:    
(Kaizen) https://info.massopen.cloud:5001/help      
(Engage1) https://e1-helpdesk.massopen.cloud/help

Currently, the General tickets all go to infra@lists.massopen.cloud or kaizen@lists.massopen.cloud.  There are two steps to updating this so that these will go to the helpdesk and be handled by UMass staff.

1. Send the tickets to Stat.
   * change the `helpdesk email` setting in `/etc/setpass.conf` on the helpdesk VM to `statmoc@umassadmin.net`.
   * Remember to commit the updated setpass.conf file to the `helpdesk/engage1` directory in the `moc` repo.

2. Route the tickets to the Monitoring queue instead of the MOC Staff queue. 
   * modify the Setpass `api.py` file.  In the function `create_help_ticket()` change the line `queue = CONF.internal_queue` to `queue = CONF.helpdesk_queue`.
   * do a PR, get it merged, and then pull down and deploy the new code.

Once the tickets are going to the Monitoring queue, you can work with the Helpdesk users to create a triage procedure so they can take over some of the "babysitting".

### Ticket routing in Stat

Tickets that we want the Helpdesk Operators to see, should go to the 'Monitoring` queue.  This will happen by default when a ticket is sent to statmoc@umassadmin.net with no queue specified.

If we want to bypass the helpdesk operators, the ticket should go to the `MOC Staff` queue, and the helpdesk operators will not see it.  This is useful for testing changes to the interface. (Kerri and the other helpdesk management folks can still see all the tickets if they look, but mostly this is for accounting purposes.)

If you have questions about how to format a ticket for correct routing, just ask Kerri, her contact info is below.

***

### MOC Staff Tickets

If the helpdesk staff cannot complete the request, they will assign the ticket to the MOC Staff queue.  Usually this happens because the script output produced an error.   The helpdesk staff will copy and paste all script output into the ticket notes to help you figure out what went wrong.  Sometimes there is a bug in the script, but this also happens if the user filled out the form incorrectly (for example, if they requested a new account when they already have one).

### Resolving a ticket
When a ticket is assigned to MOC Staff, everyone in the MOC Staff group will get an email from `statmoc@umassadmin.net` stating that a ticket has been assigned or re-assigned to you.  The details of the ticket will be in the email.

Log into Stat, find the ticket, and click the ticket to open it.  You should see the notes left by the UMass helpdesk.  From the View menu on the bottom left hand side of the page, choose CSR Properties.  Change the `Assigned User` to the person who should resolve the ticket (probably this is you) and save.

***

#### Common scenarios
* ###### user or project not found
    * This usually means the end user supplied bad information in the form, and the username or project name they gave was not found in Keystone.  
    * See if you can figure out their actual user name or project name.  
    * If it's a straightforward fix (such as a typo)
         * fix it in the Google Sheet
         * process the request
         * add a note to the ticket explaining what the issue was and how it was fixed
         * paste the script output into the ticket
    * If you're not sure what the user wants, send them an email asking for clarification, and proceed from there.

* ###### user exists
    * someone requested a new user account with an email address that is already an account, either because they forgot they have an account, or because they can't log in.  
    * Contact the user and let them know they already have an account.  Ask if they need a password reset, and perform a password reset if they do (use the PIN they entered into the form).
    * Once you figure out what they really need, follow the instructions for [dealing with bad user input](#dealing-with-bad-input)

* ###### project exists
    * someone requested a new project with a name that is already in use.  Either they were trying to join that project, or by coincidence they chose the same name as an existing project.  
    * See if you can figure out what is going on from the request comments.  Contact the user if necessary.
    * You may need to suggest a different project name - one way to make names unique is to add the name of the user or their organization to the name.
    * Once you know what they want, proceed to [dealing with bad user input](#dealing-with-bad-input)

***

### Dealing with bad input
Bad input can be a mistake made by a user, or a spam request from someone who is not approved for an account.

On the Google Sheet, add a copy of the unaltered request to "Incorrect Requests and Spam" with a brief note explaining the situation. If the request is spam, delete it from the `Form Responses 1` tab.  

If it's not spam, and you have figured out what the user really wants, edit the request in the Google Sheet so that it will accomplish the desired result.  (For example, if the user requested a new account, but already has one, edit the response so it indicates that the user already has an account).  

Note: Sometimes instead of fixing the entry, you should direct the user to fill out the form again correctly.  For example if they need to create a new user account, we need to collect their contact information.  If politically necessary, you can create the user now, but ask them to complete the form again with their information, and just move their new response to the archive tab with a note, instead of typing Approved.

Once the request is correct, log into the helpdesk VM and process the request, and paste the script output into the ticket.  Once the request has processed successfully, you can close the ticket.

***

### Closing a Ticket

Add the resolution information (script output and any notes/comments about what happened) to the Resolution field.

In the View pane on the bottom left, click `CSR Properties`.  Change the `Status` to "Closed" and click Save.  You may get a warning about incomplete Tasks.  This has to do with the UMass time tracking system.  Just ignore this warning.

***

### Contact UMass for help

If you have questions about Stat or are having any issues with it, you can email the helpdesk staff.

Our contact at UMass is Kerri Hudzikiewicz, you can also reach out to her directly with questions/problems/issues, she's very helpful:
KHudzikiewicz@umassp.edu
